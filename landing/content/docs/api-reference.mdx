# API Reference

Complete API documentation for OpenShortPath endpoints.

## Base URL

All API endpoints are prefixed with `/api/v1`.

## Authentication

Include the JWT token in the `Authorization` header:

```text
Authorization: Bearer <your-jwt-token>
```

## Endpoints

### Create Short URL

Create a new short URL.

**Endpoint:** `POST /api/v1/shorten`

**Authentication:** Required (JWT)

**Request Body:**

```json
{
  "domain": "lcd.sh",
  "url": "https://github.com/openshortpath",
  "slug": "custom-slug"
}
```

**Note:** The `slug` field is optional. If not provided, a random 5-character slug will be generated.

**Response:**

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "domain": "lcd.sh",
  "slug": "custom-slug",
  "url": "https://github.com/openshortpath",
  "user_id": "550e8400-e29b-41d4-a716-446655440000",
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z"
}
```

**Status Codes:**
- `201 Created`: Short URL created successfully
- `400 Bad Request`: Invalid request body or domain not available
- `401 Unauthorized`: Authentication required
- `409 Conflict`: Short URL with domain and slug already exists
- `500 Internal Server Error`: Server error

### List Short URLs

Get a paginated list of short URLs for the authenticated user.

**Endpoint:** `GET /api/v1/short-urls`

**Authentication:** Required (JWT)

**Query Parameters:**
- `page` (optional): Page number (default: 1)
- `limit` (optional): Items per page (default: 20, max: 100)

**Example Request:**

```text
GET /api/v1/short-urls?page=1&limit=20
```

**Response:**

```json
{
  "urls": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "domain": "lcd.sh",
      "slug": "abc123",
      "url": "https://github.com/openshortpath",
      "user_id": "550e8400-e29b-41d4-a716-446655440000",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  ],
  "page": 1,
  "limit": 20,
  "total": 1,
  "total_pages": 1
}
```

**Status Codes:**
- `200 OK`: Success
- `401 Unauthorized`: Authentication required
- `500 Internal Server Error`: Server error

### Get Short URL

Get a single short URL by ID.

**Endpoint:** `GET /api/v1/short-urls/:id`

**Authentication:** Required (JWT)

**Response:**

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "domain": "lcd.sh",
  "slug": "abc123",
  "url": "https://github.com/openshortpath",
  "user_id": "550e8400-e29b-41d4-a716-446655440000",
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z"
}
```

**Status Codes:**
- `200 OK`: Success
- `401 Unauthorized`: Authentication required
- `404 Not Found`: Short URL not found
- `500 Internal Server Error`: Server error

### Update Short URL

Update a short URL by ID.

**Endpoint:** `PUT /api/v1/short-urls/:id`

**Authentication:** Required (JWT)

**Request Body:**

```json
{
  "url": "https://github.com/openshortpath/updated",
  "slug": "new-slug",
  "domain": "lcd.sh"
}
```

**Note:** All fields are optional. Only provided fields will be updated.

**Response:**

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "domain": "lcd.sh",
  "slug": "new-slug",
  "url": "https://github.com/openshortpath/updated",
  "user_id": "550e8400-e29b-41d4-a716-446655440000",
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z"
}
```

**Status Codes:**
- `200 OK`: Short URL updated successfully
- `400 Bad Request`: Invalid request body or domain not available
- `401 Unauthorized`: Authentication required
- `404 Not Found`: Short URL not found
- `409 Conflict`: Short URL with domain and slug already exists
- `500 Internal Server Error`: Server error

### Delete Short URL

Delete a short URL by ID.

**Endpoint:** `DELETE /api/v1/short-urls/:id`

**Authentication:** Required (JWT)

**Response:** No content (204)

**Status Codes:**
- `204 No Content`: Short URL deleted successfully
- `401 Unauthorized`: Authentication required
- `404 Not Found`: Short URL not found
- `500 Internal Server Error`: Server error

## Error Responses

All error responses follow this format:

```json
{
  "error": "Error message",
  "details": "Additional error details (optional)"
}
```

## Examples

### Example: Create Short URL with cURL

```bash
curl -X POST https://api.example.com/api/v1/shorten \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "domain": "lcd.sh",
    "url": "https://github.com/openshortpath",
    "slug": "my-link"
  }'
```

### Example: Create Short URL with JavaScript

```javascript
const response = await fetch('https://api.example.com/api/v1/shorten', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer YOUR_JWT_TOKEN'
  },
  body: JSON.stringify({
    domain: 'lcd.sh',
    url: 'https://github.com/openshortpath',
    slug: 'my-link'
  })
});

const data = await response.json();
console.log(data);
```

